<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta content="#ffffff" name="theme-color" />
  <meta content="#da532c" name="msapplication-TileColor" />

  
  
  
  
  

  

  

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.1/css/academicons.min.css" integrity="sha384-FIue+PI4SsI9XfHCz8dBLg33b0c1fMJgNU3X//L26FYbGnlSEfWmNT7zgWc2N9b6" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link href="https://lymslive.github.io/deep-thought.css" rel="stylesheet" />
  
<link href="/page-patch.css" rel="stylesheet" />


  <title>
    
沉思涧 | vim 笔记插件 vnote 设计反思

  </title>

  
  
  

  
</head>

<body class="has-background-white">
  <nav aria-label="section navigation" class="navbar is-light" role="navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item is-size-5 has-text-weight-bold" href="https:&#x2F;&#x2F;lymslive.github.io">沉思涧</a>
        <a aria-expanded="false" aria-label="menu" class="navbar-burger burger" data-target="navMenu" role="button">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu" id="navMenu">
        <div class="navbar-end has-text-centered">
          
          
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;">
            首页
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;blog">
            博客
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;book">
            书册
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;think">
            文思
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;white">
            白学
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;tags">
            标签
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;categories">
            归类
          </a>
          
          
          
          <a class="navbar-item" id="nav-search" title="Search" data-target="#search-modal">
            <span class="icon">
              <i class="fas fa-search"></i>
            </span>
          </a>
          <a class="navbar-item" id="dark-mode" title="Switch to dark theme">
            <span class="icon">
              <i class="fas fa-adjust"></i>
            </span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  
  

  
<section class="section">
  <div class="container">
    <div class="columns">
      <div class="column is-8 is-offset-2">
        <article class="box">
          <h1 class="title">
            vim 笔记插件 vnote 设计反思
          </h1>
          <p class="subtitle"></p>
          <div class="columns is-multiline is-gapless">
            <div class="column is-8">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="fas fa-user"></i>
  </span>
  <span>七阶子</span>
  <span class="icon">
    <i class="far fa-calendar-alt"></i>
  </span>
  <span><time datetime="2023-12-03">2023-12-03</time></span>
</span>

            </div>
            <div class="column is-4 has-text-right-desktop">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="far fa-clock"></i>
  </span>
  <span>13 min,</span>
  <span class="icon">
    <i class="fas fa-pencil-alt"></i>
  </span>
  <span>2457 words</span>
</span>

            </div>
            <div class="column">
              
              
<p>
  归类：
  
  <a class="has-text-info-dark has-text-weight-semibold" href="https://lymslive.github.io/categories/cheng-xu-she-ji/">
    <span class="icon-text">
      <span class="icon">
        <i class="fas fa-cube"></i>
      </span>
      <span>程序设计</span>
    </span>
  </a>
  
</p>

              
            </div>
            <div class="column has-text-right-desktop">
              
              
<p>
  标签：
  
  <a class="has-text-info-dark has-text-weight-semibold" href="https://lymslive.github.io/tags/c/">
    <span class="icon-text">
      <span class="icon">
        <i class="fas fa-tag"></i>
      </span>
      <span>C++</span>
    </span>
  </a>
  
  <a class="has-text-info-dark has-text-weight-semibold" href="https://lymslive.github.io/tags/vim/">
    <span class="icon-text">
      <span class="icon">
        <i class="fas fa-tag"></i>
      </span>
      <span>vim</span>
    </span>
  </a>
  
</p>

              
            </div>
          </div>
          <div class="content mt-2" id="article-content">
            <p>几年前，刚转行为专职程序员不久时，出于对 vim 的喜爱与信仰，自己开发了一个 vim
插件，以支持在 vim 环境内记笔记及管理笔记。我知道市面上有不少笔记软件，但记笔
记这事是很个性化的东西，而且很多吹成云笔记的产品，把个人笔记上传到人家服务器上，
怎么都觉得有点敏感。所以我决定就用 vim 在本地写 markdown 文本笔记，要怎么上传
至 github 托管仓库，也是自己能完全控制的。基于这个出发点，我自行设计并开发
vnote 插件，虽然基本只是给自己用吧，当初也乐此不疲。</p>
<p>但是再过几年回头再看，这个插件软件可能设计的不尽如人意。</p>
<span id="continue-reading"></span><h2 id="vnote-xiang-mu-gai-kuang">vnote 项目概况</h2>
<p>项目地址在 <a href="https://github.com/lymslive/vnote">https://github.com/lymslive/vnote</a>，
这是标准的 vim 插件目录结构。</p>
<p>强依赖另一个 vim 项目，<a href="https://github.com/lymslive/vimloo">vimloo</a> 。这算是
viml 的基础代码库，我推出的用面向对象的思想来写 viml 代码，很多基础设施就放在
了 <code>vimloo</code> 仓库。这两者或许是相辅相成的，也可能是先想到了 <code>vimloo</code> ，而
<code>vnote</code> 就是个具体的练手项目。</p>
<p>在初期，还有个配套辅助的 C++ 命令行工具，
<a href="https://github.com/lymslive/vnote-tool">lymslive/vnote-tool</a>
用于为一个笔记本目录生成索引及查询。后来从 vnote 插件仓库剥离出去。可能由于需
要额外编译，使用度不高。原计划想做成 vim 通过异步 channel 与该外部工具的通讯也
没实现。后来又写了几个 perl 脚本，放在 vnote 插件目录，重建索引还更方便。perl
处理文本还是有优势的。</p>
<p>然后我自己实际的笔记本仓库是 
<a href="https://github.com/lymslive/notebook">lymslive/notebook</a> 。当然现在是设为
private 访问权限，不适合公开的。</p>
<p>比较遗憾的是，这几个仓库，几年后都渐失维护，少有更新了，包含 notebook 内容。</p>
<p>记得 SpaceVim 项目曾收录 vnote 插件，但我本身不喜欢用别人整的开箱即用的配置好
的 vim ，所以也没跟踪 vnote 的使用率。推广与运营，向来不是我所擅长的，但这并不
是我对 vnote 感到纠结的地方。而我主要遗憾的是 vnote 本身渐渐不能让自己满意了。</p>
<h2 id="vnote-de-zhu-yao-wen-ti">vnote 的主要问题</h2>
<p>一个主要问题可能是过度设计，对笔记本目录结构与笔记文本名的约定设计偏复杂了。
vnote 假定一篇笔记是一个 markdown 文件，文件名位于
<code>${NoteBook}/d/yyyy/mm/dd/yyyymmdd_x.md</code> 。其中为每层年、月、日建立目录，而笔
记文件名也包含 <code>yyyymmdd</code> 8 位数字拼接的年月日信息作为前缀，再加个编号后缀，因
为当然设想要支持一天写多篇笔记的情况，所以加编号。</p>
<p>这其中最大的现实问题是，高估了用户（比如我自己）写笔记的热情。一般用户可能很难
坚持每天写笔记，更别说每天写几篇了。所以大部分情况下，三层日目录下只有一个文件
<code>yyyymmdd_1.md</code> ，显得很冗余滑稽。还有很多日期是一篇笔记也没有的，也就不会建那
天的目录。但在顶层目录只看到年份，不能直观看到里面哪个月哪天是空缺的。</p>
<p>vim 的哲学是做好一件事，所以仍有时候我想在 shell 下进入笔记本目录去查看，也就
是 <code>cd</code> 与 <code>ls</code> 的常规。所以三层目录结构的设计造成很大困扰。如果能重新设计，我
想就平坦一层的 <code>yyyy-mm-dd</code> 目录会更方便。没必要担心子目录名太多，能写一年也就
三百多个目录，能坚持三年不间断也就一千左右个子目录。类似 <code>ls</code> 的命令也完全可以
加上通配符过滤只列某年或某年月的日记目录。</p>
<p>目录太深可能也让我忽略了在每天目录下还能放非 <code>.md</code> 文件，如插图，没意识或不方
便去维护可能有用的配图表，最多只用超链接记下参考资料来源。</p>
<p>笔记文件名还有个不良的设计是，可以再加后缀表示私有日记，如 <code>yyyymmdd_x-.md</code> ，
可在 <code>.gitignore</code> 中加入规则忽略提交。这又进一步增加复杂度。可能当时的 github
免费用户，还不允许设私有仓库。否则将整个笔记本仓库设为私有是最恰当的，完全没必
要在同一个笔记本公私混杂。真有这么闲，可以建两个笔记本仓库，一个公开，一个不公
开。</p>
<p>vnote 的第二个问题是，我在使用过程中可能偏离了它作为简单笔记的初衷。后来还迁入
了大量长篇大论的原创文章，搞得像要维护博客的站点内容一样。</p>
<p>这也有个原由，之前忘记从哪得到一个阿里云的优惠促销券，买了个低配的云服务器，用
于学习练手。就想手动搭个博客网站。我寻思着博客建站主要还是内容，建站技术还是其
次。我在笔记本 notebook 存的文档有一定组织规律，适合转成 html 静态网站。但
notebok 里面的原创内容还是不够看。所以我就将早年在国内一些网站如网易博客、新浪
博客、百度贴吧写的文章，备份文档，导入 notebook 了。国内那些博客网站如今基本死
了，我之前在上面写的是非 IT 技术文章。</p>
<p>历史备份博客文章导入 notebook 后，也导致 vnote 插件的管理复杂度提升，可能多级
标签系统就是那时引入的。</p>
<p>其实，博客与笔记还是有很大不同的。博客文章是原创的，比较成熟与成体系的写作，并
且是有意分享与公开出去的。而笔记是比较松散的，记录学习知识点，或不成熟的头脑风
暴点子，并不适合公开。仅管有时在笔记中随手记下的点子有可能孵化出博客文章，然而
区别还是显而易见的。所以强行放在一起管理，并不是很合适，尤其是一开始可能并未仔
细考虑到这种需求。</p>
<p>只是从个人角度，利用 notebook 完成了一次对早年博客文章的备份归档，也是体现了价
值的。那些博客文章虽然对我今后程序员职业并无助益，但无疑也是值得蔽帚自珍的。国
内建博客网站挺麻烦的，备案监管就一堆破事。所以当阿里云服务器优惠到期后，也就没
续了。想来在那段时间的一个实践成就，就是依托 notebook 的内容，学习了用 go 的基
本 Http 功能建站，后来还是换 perl 了。我在工作之外的个人项目中大量使用 viml 与
perl ，也是任性。</p>
<p>现在不想太折腾了，github page 应该是比较稳定的，国内访问速度不稳定的因素就不考
虑了。因此打算把 github page 搞起来，也不想自己从头搞山寨了，就找开源的静态
html 渲染系统与网站主题，当然也是任性选了 rust 系的 zola 。后面也许会把
notebook 私库备份中值得公开的博客文章迁到 github page 了。</p>
<p>第三个问题也是个人使用的问题，后来没有坚持写笔记了。notebook 仓库在某年开始近
乎停更了。</p>
<p>直接起因可能是某次换工作了，新公司对员工上网控制比较严格，刚入职时也比较小心翼
翼。所以可能不太方便从 github 拉下原来的 notobook ，继续原来的笔记体系。仅管也
可以在工作机本地建个笔记本，也在纠结中意兴阑珊了。一旦中断了写笔记，再拾起来就
难了。</p>
<p>也正因一度中断使用 notebook 与 vnote ，在淡忘之后回头再看，容易以一种局外人用
户而非开发者的角度看重新审视其利弊，更能体验到哪些是直观的核心功能，哪些是不必
要的复杂功能。也幸好当初留下了不少文档说明，仅管有些文档没有随后续开发修改同步
更新，但也还是个指引。不过也犯了个低级错误，vnote 与 vimloo 默认 clone 下来时
不在同一个分支，一个在 master 一个在 dev ，结果运行起来报了好多错误，好久没写
viml 代码，有点慌。后来把两个仓库代码的 dev 都合到 master ，一起用 master 就没
有问题了。</p>
<h2 id="zong-jie">总结</h2>
<p>复盘了程序员生涯第一次写的个人项目，vim 的笔记插件 vnote ，以及自用记笔记维护
notebook 笔记本的历程。并不算太成功，大致有以下几点问题：</p>
<ul>
<li>设计的笔记文档目录结构复杂，导致功能也复杂，有点过度设计的意味。</li>
<li>对公有笔记、私有日记及博客文章的概念模糊不清，产品定位不太明晰。</li>
<li>没有坚持写笔记。</li>
<li>没有心力去推广 vimloo 的基本思想，这也许是比开发具体的 vim 插件更有意义的。</li>
</ul>
<p>不管如何，汲取经验教训。后面的 flag 就先不立了。</p>

          </div>
        </article>
      </div>
      
    </div>
  </div>
</section>


  
  <section class="modal" id="search-modal">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <p class="modal-card-title">Search</p>
      </header>
      <section class="modal-card-body">
        <div class="field mb-2">
          <div class="control">
            <input class="input" id="search" placeholder="Search this website." type="search" />
          </div>
        </div>
        <div class="search-results">
          <div class="search-results__items"></div>
        </div>
      </section>
    </div>
    <button aria-label="close" class="modal-close is-large"></button>
  </section>
  


  

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <nav class="level">
              
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;blog&#x2F;systemd-service-practice&#x2F;">
              <span class="icon mr-2">
                <i class="fas fa-arrow-circle-left"></i>
              </span>
              探索 systemd 管理服务之旅
            </a>
          </div>
           
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;lymslive.github.io&#x2F;blog&#x2F;analyse-log-with-perl&#x2F;">
              用 perl 统计分析日志应用实战<span class="icon ml-2">
                <i class="fas fa-arrow-circle-right"></i>
              </span>
            </a>
          </div>
          
        </nav>
      </div>
    </div>
  </div>
</section>



  



  
  <footer class="footer py-4">
    <div class="content has-text-centered">
      <p>
        Contact
        <a class="has-text-black" href="mailto:403708621@qq.com" target="_blank">
          <span class="icon is-large" title="Email">
            <i class="far fa-envelope fa-lg"></i>
          </span>
        </a>
        Issue
        <a class="has-text-github" href="https://github.com/lymslive/lymslive.github.io/issues" target="_blank">
          <span class="icon is-large" title="GitHub">
            <i class="fab fa-github fa-lg"></i>
          </span>
        </a>
      </p>
      <p>
        Powered by
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-power-off"></i>
          </span>
          <span>zola</span>
        </span>
        with
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-code"></i>
          </span>
          <span>code</span>
        </span>
        and
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-heart"></i>
          </span>
          <span>love</span>
        </span>
      </p>
    </div>
  </footer>
  

  
  
  
  
  <script src="https://lymslive.github.io/elasticlunr.min.js"></script>
  <script src="https://lymslive.github.io/search_index.en.js"></script><script src="https://lymslive.github.io/js/site.js"></script>

  





  
<script src="https://lymslive.github.io/js/chinese-format.js"></script>

</body>

</html>
